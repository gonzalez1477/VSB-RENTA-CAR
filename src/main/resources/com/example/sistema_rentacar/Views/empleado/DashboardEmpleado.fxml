<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<HBox xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.example.sistema_rentacar.Controllers.Empleado.DashboardEmpleadoController"
      minHeight="700" minWidth="1000"
      stylesheets="@../../css/estilosTablas.css">

    <!-- SIDEBAR -->
    <VBox prefWidth="280" styleClass="sidebar-container" style="-fx-background-color: linear-gradient(to bottom, #2c3e50, #34495e);">
        <padding>
            <Insets top="30" bottom="30" left="20" right="20"/>
        </padding>

        <!-- Logo/TÃ­tulo -->
        <VBox alignment="CENTER" spacing="10" styleClass="sidebar-logo">
            <Label style="-fx-text-fill: white; -fx-font-size: 24px; -fx-font-weight: bold;" text="VSB"/>
            <Label style="-fx-text-fill: #3498db; -fx-font-size: 18px; -fx-font-weight: bold;" text="Renta Car"/>
            <Label style="-fx-text-fill: #95a5a6; -fx-font-size: 12px; -fx-font-style: italic;" text="Panel de Empleado"/>
        </VBox>

        <Separator styleClass="sidebar-separator" style="-fx-background-color: rgba(255,255,255,0.2);">
            <VBox.margin>
                <Insets bottom="20"/>
            </VBox.margin>
        </Separator>

        <!-- InformaciÃ³n del Usuario -->
        <VBox spacing="10" styleClass="sidebar-user-info">
            <Label fx:id="lblEmpleado" style="-fx-text-fill: white; -fx-font-size: 14px; -fx-font-weight: bold;" text="Usuario"/>
            <Label fx:id="lblCargo" style="-fx-text-fill: #bdc3c7; -fx-font-size: 12px;" text="Cargo"/>
        </VBox>

        <!-- Espaciador pequeÃ±o -->
        <Region VBox.vgrow="NEVER" styleClass="sidebar-spacer">
            <VBox.margin>
                <Insets top="20" bottom="10"/>
            </VBox.margin>
        </Region>

        <!-- MenÃº de NavegaciÃ³n Principal -->
        <VBox spacing="10" styleClass="sidebar-nav-section">
            <Label styleClass="sidebar-section-label" text="NAVEGACIÃ“N"/>

            <Button fx:id="btnDashboard"
                    onAction="#handleNavigateToDashboard"
                    maxWidth="Infinity"
                    styleClass="btn-nav, btn-nav-active"
                    text="  ðŸ“Š  Dashboard"/>

            <Button fx:id="btnVehiculos"
                    onAction="#handleNavigateToVehiculos"
                    maxWidth="Infinity"
                    styleClass="btn-nav"
                    text="  ðŸš—  VehÃ­culos"/>

            <Button fx:id="btnClientes"
                    onAction="#handleNavigateToClientes"
                    maxWidth="Infinity"
                    styleClass="btn-nav"
                    text="  ðŸ‘¥  Clientes"/>

            <Button fx:id="btnAlquileres"
                    onAction="#handleNavigateToAlquileres"
                    maxWidth="Infinity"
                    styleClass="btn-nav"
                    text="  ðŸ“‹  Alquileres Activos"/>

            <Button fx:id="btnCategorias"
                    onAction="#handleNavigateToCategorias"
                    maxWidth="Infinity"
                    styleClass="btn-nav"
                    text="  ðŸ“‚  CategorÃ­as"/>
        </VBox>

        <!-- SecciÃ³n de AdministraciÃ³n (oculta por defecto) -->
        <VBox spacing="10" styleClass="sidebar-nav-section" fx:id="seccionAdmin" visible="false" managed="false">
            <VBox.margin>
                <Insets top="10"/>
            </VBox.margin>

            <Separator fx:id="separadorAdmin" styleClass="sidebar-separator" style="-fx-background-color: rgba(255,255,255,0.2);"/>

            <Label fx:id="lblAdminSection" styleClass="sidebar-section-label" text="ADMINISTRACIÃ“N"/>

            <Button fx:id="btnEmpleados"
                    onAction="#handleNavigateToEmpleados"
                    maxWidth="Infinity"
                    styleClass="btn-nav"
                    text="  ðŸ‘”  Empleados"/>
        </VBox>

        <!-- Espaciador flexible que empuja el botÃ³n de cerrar sesiÃ³n al fondo -->
        <Region VBox.vgrow="ALWAYS" styleClass="sidebar-spacer"/>

        <!-- BotÃ³n Cerrar SesiÃ³n al final -->
        <Button onAction="#handleCerrarSesion"
                maxWidth="Infinity"
                styleClass="btn-logout"
                text="ðŸšª Cerrar SesiÃ³n">
            <VBox.margin>
                <Insets top="20"/>
            </VBox.margin>
        </Button>

        <!-- <Label styleClass="sidebar-footer" style="-fx-text-fill: #7f8c8d; -fx-font-size: 10px;" text="Â© 2025 VSB Renta Car" wrapText="true">
            <VBox.margin>
                <Insets top="15"/>
            </VBox.margin>
        </Label> -->

    </VBox>

    <!-- Ãrea de Contenido Principal -->
    <BorderPane HBox.hgrow="ALWAYS" style="-fx-background-color: #ecf0f1;">

        <!-- Header del contenido -->
        <top>
            <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-background-color: white; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                <Label fx:id="lblTituloSeccion" style="-fx-text-fill: #2c3e50; -fx-font-size: 24px; -fx-font-weight: bold;" text="Dashboard"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="lblSubtituloSeccion" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;" text="Resumen General"/>
            </HBox>
        </top>

        <!-- Contenedor de vistas dinÃ¡micas -->
        <center>
            <StackPane fx:id="contenedorVistas" style="-fx-background-color: transparent;">

                <!-- Vista: Dashboard -->
                <ScrollPane fx:id="vistaDashboard" fitToWidth="true" style="-fx-background-color: transparent; -fx-background: #ecf0f1;">
                    <VBox spacing="30" style="-fx-padding: 30;">

                        <!-- Tarjetas de EstadÃ­sticas -->
                        <GridPane hgap="25" vgap="25">

                            <!-- Total VehÃ­culos -->
                            <VBox spacing="15" styleClass="dashboard-card, card-blue"
                                  GridPane.columnIndex="0" GridPane.rowIndex="0">
                                <HBox alignment="CENTER_LEFT" spacing="15">
                                    <Label text="ðŸš—" styleClass="card-icon"/>
                                    <VBox spacing="8" HBox.hgrow="ALWAYS">
                                        <Label text="Total VehÃ­culos" styleClass="card-title"/>
                                        <Label fx:id="lblTotalVehiculos" text="0" styleClass="card-number"/>
                                    </VBox>
                                </HBox>
                                <Region styleClass="card-divider"/>
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Region styleClass="card-indicator, indicator-blue"/>
                                    <Label text="En el sistema" styleClass="card-description"/>
                                </HBox>
                            </VBox>

                            <!-- Disponibles -->
                            <VBox spacing="15" styleClass="dashboard-card, card-green"
                                  GridPane.columnIndex="1" GridPane.rowIndex="0">
                                <HBox alignment="CENTER_LEFT" spacing="15">
                                    <Label text="âœ…" styleClass="card-icon"/>
                                    <VBox spacing="8" HBox.hgrow="ALWAYS">
                                        <Label text="Disponibles" styleClass="card-title"/>
                                        <Label fx:id="lblVehiculosDisponibles" text="0" styleClass="card-number"/>
                                    </VBox>
                                </HBox>
                                <Region styleClass="card-divider"/>
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Region styleClass="card-indicator, indicator-green"/>
                                    <Label text="Listos para alquilar" styleClass="card-description"/>
                                </HBox>
                            </VBox>

                            <!-- Alquilados -->
                            <VBox spacing="15" styleClass="dashboard-card, card-red"
                                  GridPane.columnIndex="2" GridPane.rowIndex="0">
                                <HBox alignment="CENTER_LEFT" spacing="15">
                                    <Label text="ðŸ”’" styleClass="card-icon"/>
                                    <VBox spacing="8" HBox.hgrow="ALWAYS">
                                        <Label text="Alquilados" styleClass="card-title"/>
                                        <Label fx:id="lblVehiculosAlquilados" text="0" styleClass="card-number"/>
                                    </VBox>
                                </HBox>
                                <Region styleClass="card-divider"/>
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Region styleClass="card-indicator, indicator-red"/>
                                    <Label text="En uso actualmente" styleClass="card-description"/>
                                </HBox>
                            </VBox>

                            <!-- Alquileres Activos -->
                            <VBox spacing="15" styleClass="dashboard-card, card-orange"
                                  GridPane.columnIndex="0" GridPane.rowIndex="1">
                                <HBox alignment="CENTER_LEFT" spacing="15">
                                    <Label text="ðŸ“‹" styleClass="card-icon"/>
                                    <VBox spacing="8" HBox.hgrow="ALWAYS">
                                        <Label text="Alquileres Activos" styleClass="card-title"/>
                                        <Label fx:id="lblAlquileresActivos" text="0" styleClass="card-number"/>
                                    </VBox>
                                </HBox>
                                <Region styleClass="card-divider"/>
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Region styleClass="card-indicator, indicator-orange"/>
                                    <Label text="Contratos vigentes" styleClass="card-description"/>
                                </HBox>
                            </VBox>

                            <!-- Total Clientes -->
                            <VBox spacing="15" styleClass="dashboard-card, card-purple"
                                  GridPane.columnIndex="1" GridPane.rowIndex="1">
                                <HBox alignment="CENTER_LEFT" spacing="15">
                                    <Label text="ðŸ‘¥" styleClass="card-icon"/>
                                    <VBox spacing="8" HBox.hgrow="ALWAYS">
                                        <Label text="Total Clientes" styleClass="card-title"/>
                                        <Label fx:id="lblTotalClientes" text="0" styleClass="card-number"/>
                                    </VBox>
                                </HBox>
                                <Region styleClass="card-divider"/>
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Region styleClass="card-indicator, indicator-purple"/>
                                    <Label text="Registrados en el sistema" styleClass="card-description"/>
                                </HBox>
                            </VBox>

                            <!-- Tarjeta Extra (Opcional - Puedes eliminarla si no la necesitas) -->
                            <VBox spacing="15" styleClass="dashboard-card, card-teal"
                                  GridPane.columnIndex="2" GridPane.rowIndex="1">
                                <HBox alignment="CENTER_LEFT" spacing="15">
                                    <Label text="ðŸ’°" styleClass="card-icon"/>
                                    <VBox spacing="8" HBox.hgrow="ALWAYS">
                                        <Label text="Ingresos del Mes" styleClass="card-title"/>
                                        <Label fx:id="lblIngresosMes" text="\$0.00" styleClass="card-number" style="-fx-font-size: 40px;"/>
                                    </VBox>
                                </HBox>
                                <Region styleClass="card-divider"/>
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Region styleClass="card-indicator, indicator-teal"/>
                                    <Label text="Total facturado" styleClass="card-description"/>
                                </HBox>
                            </VBox>

                            <columnConstraints>
                                <ColumnConstraints percentWidth="33.33"/>
                                <ColumnConstraints percentWidth="33.33"/>
                                <ColumnConstraints percentWidth="33.33"/>
                            </columnConstraints>
                        </GridPane>

                    </VBox>
                </ScrollPane>

                <!-- Vista: VehÃ­culos -->
                <VBox fx:id="vistaVehiculos" spacing="15" style="-fx-padding: 30; -fx-background-color: transparent;" visible="false" managed="false">

                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <TextField fx:id="txtBuscarVehiculo" promptText="ðŸ” Buscar por placa, marca o modelo..."
                                   prefWidth="400" style="-fx-font-size: 14px; -fx-padding: 10;"/>

                        <Region HBox.hgrow="ALWAYS"/>

                        <Button fx:id="btnAgregarVehiculo" text="âž• Nuevo VehÃ­culo" onAction="#handleAgregarVehiculo"
                                styleClass="btn-success"/>

                        <Button fx:id="btnEditarVehiculo" text="âœï¸ Editar" onAction="#handleEditarVehiculo" disable="true"
                                styleClass="btn-primary"/>

                        <Button fx:id="btnEliminarVehiculo" text="ðŸ—‘ï¸ Eliminar" onAction="#handleEliminarVehiculo" disable="true"
                                styleClass="btn-danger"/>
                    </HBox>

                    <TableView fx:id="tableVehiculos" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colVehId" text="ID" prefWidth="50"/>
                            <TableColumn fx:id="colVehPlaca" text="Placa" prefWidth="100"/>
                            <TableColumn fx:id="colVehMarca" text="Marca" prefWidth="120"/>
                            <TableColumn fx:id="colVehModelo" text="Modelo" prefWidth="120"/>
                            <TableColumn fx:id="colVehAnio" text="AÃ±o" prefWidth="70"/>
                            <TableColumn fx:id="colVehTipo" text="Tipo" prefWidth="100"/>
                            <TableColumn fx:id="colVehTarifa" text="Tarifa/DÃ­a" prefWidth="100"/>
                            <TableColumn fx:id="colVehEstado" text="Estado" prefWidth="100"/>
                        </columns>
                    </TableView>

                </VBox>

                <!-- Vista: Clientes -->
                <VBox fx:id="vistaClientes" spacing="15" style="-fx-padding: 30; -fx-background-color: transparent;" visible="false" managed="false">

                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <TextField fx:id="txtBuscarCliente" promptText="ðŸ” Buscar cliente..."
                                   prefWidth="400" style="-fx-font-size: 14px; -fx-padding: 10;"/>

                        <Region HBox.hgrow="ALWAYS"/>

                        <Button fx:id="btnVerHistorialCliente" text="ðŸ“‹ Ver Historial" onAction="#handleVerHistorialCliente" disable="true"
                                styleClass="btn-primary"/>

                        <Button text="ðŸ”„ Refrescar" onAction="#handleRefrescarClientes"
                                styleClass="btn-success"/>
                    </HBox>

                    <TableView fx:id="tableClientes" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colCliId" text="ID" prefWidth="50"/>
                            <TableColumn fx:id="colCliNombre" text="Nombre Completo" prefWidth="200"/>
                            <TableColumn fx:id="colCliEmail" text="Email" prefWidth="200"/>
                            <TableColumn fx:id="colCliTelefono" text="TelÃ©fono" prefWidth="120"/>
                            <TableColumn fx:id="colCliDui" text="DUI" prefWidth="120"/>
                            <TableColumn fx:id="colCliLicencia" text="Licencia" prefWidth="120"/>
                            <TableColumn fx:id="colCliActivo" text="Estado" prefWidth="80"/>
                        </columns>
                    </TableView>

                </VBox>

                <!-- Vista: Alquileres Activos -->
                <VBox fx:id="vistaAlquileres" spacing="15" style="-fx-padding: 30; -fx-background-color: transparent;" visible="false" managed="false">

                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <Region HBox.hgrow="ALWAYS"/>

                        <Button fx:id="btnFinalizarAlquiler" text="âœ”ï¸ Finalizar Alquiler" onAction="#handleFinalizarAlquiler" disable="true"
                                styleClass="btn-success"/>

                        <Button fx:id="btnRefrescarAlquileres" text="ðŸ”„ Refrescar" onAction="#handleRefrescarAlquileres"
                                styleClass="btn-primary"/>
                    </HBox>

                    <TableView fx:id="tableAlquileres" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colAlqId" text="ID" prefWidth="50"/>
                            <TableColumn fx:id="colAlqCliente" text="Cliente" prefWidth="180"/>
                            <TableColumn fx:id="colAlqVehiculo" text="VehÃ­culo" prefWidth="180"/>
                            <TableColumn fx:id="colAlqPlaca" text="Placa" prefWidth="100"/>
                            <TableColumn fx:id="colAlqFechaInicio" text="Fecha Inicio" prefWidth="150"/>
                            <TableColumn fx:id="colAlqDias" text="DÃ­as" prefWidth="70"/>
                            <TableColumn fx:id="colAlqCosto" text="Costo Total" prefWidth="100"/>
                            <TableColumn fx:id="colAlqEstado" text="Estado" prefWidth="200"/>
                        </columns>
                    </TableView>

                </VBox>

                <!-- Vista: Empleados (Solo Admin) -->
                <VBox fx:id="vistaEmpleados" spacing="15" style="-fx-padding: 30; -fx-background-color: transparent;" visible="false" managed="false">

                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <TextField fx:id="txtBuscarEmpleado" promptText="ðŸ” Buscar empleado..."
                                   prefWidth="450" style="-fx-font-size: 14px; -fx-padding: 10;"/>

                        <Region HBox.hgrow="ALWAYS"/>

                        <Button fx:id="btnAgregarEmpleado" text="âž• Nuevo" onAction="#handleAgregarEmpleado"
                                styleClass="btn-success"/>

                        <Button fx:id="btnEditarEmpleado" text="âœï¸ Editar" onAction="#handleEditarEmpleado" disable="true"
                                styleClass="btn-primary"/>

                        <Button fx:id="btnDesactivarEmpleado" text="ðŸš« Desactivar" onAction="#handleDesactivarEmpleado" disable="true"
                                styleClass="btn-warning"/>

                        <Button fx:id="btnEliminarEmpleado" text="ðŸ—‘ï¸ Eliminar" onAction="#handleEliminarEmpleado" disable="true"
                                styleClass="btn-danger"/>

                        <Button text="ðŸ”„" onAction="#handleRefrescarEmpleados"
                                styleClass="btn-info, btn-icon"/>
                    </HBox>

                    <TableView fx:id="tableEmpleados" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colEmpId" text="ID" prefWidth="50"/>
                            <TableColumn fx:id="colEmpNombre" text="Nombre Completo" prefWidth="200"/>
                            <TableColumn fx:id="colEmpEmail" text="Email" prefWidth="200"/>
                            <TableColumn fx:id="colEmpTelefono" text="TelÃ©fono" prefWidth="120"/>
                            <TableColumn fx:id="colEmpUsuario" text="Usuario" prefWidth="120"/>
                            <TableColumn fx:id="colEmpCargo" text="Cargo" prefWidth="120"/>
                            <TableColumn fx:id="colEmpFechaContratacion" text="F. ContrataciÃ³n" prefWidth="120"/>
                            <TableColumn fx:id="colEmpActivo" text="Estado" prefWidth="100"/>
                        </columns>
                    </TableView>

                </VBox>

                <!-- Vista: CategorÃ­as (Solo Admin) -->
                <VBox fx:id="vistaCategorias" spacing="15" style="-fx-padding: 30; -fx-background-color: transparent;" visible="false" managed="false">

                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <Region HBox.hgrow="ALWAYS"/>

                        <Button fx:id="btnAgregarTipo" text="âž• Nueva CategorÃ­a" onAction="#handleAgregarTipo"
                                styleClass="btn-success"/>

                        <Button fx:id="btnEditarTipo" text="âœï¸ Editar" onAction="#handleEditarTipo" disable="true"
                                styleClass="btn-primary"/>

                        <Button fx:id="btnEliminarTipo" text="ðŸ—‘ï¸ Eliminar" onAction="#handleEliminarTipo" disable="true"
                                styleClass="btn-danger"/>
                    </HBox>

                    <TableView fx:id="tableTipos" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colTipoId" text="ID" prefWidth="50"/>
                            <TableColumn fx:id="colTipoNombre" text="Nombre" prefWidth="200"/>
                            <TableColumn fx:id="colTipoTarifa" text="Tarifa/DÃ­a" prefWidth="120"/>
                            <TableColumn fx:id="colTipoDescripcion" text="DescripciÃ³n" prefWidth="400"/>
                        </columns>
                    </TableView>

                </VBox>

            </StackPane>
        </center>

    </BorderPane>

</HBox>